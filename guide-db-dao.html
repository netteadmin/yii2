<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        
<link href="./assets/95ffbc2e/css/bootstrap.css" rel="stylesheet">
<link href="./assets/6ee26e89/solarized-light.css" rel="stylesheet">
<link href="./assets/da0a60fc/style.css" rel="stylesheet">
<script src="./assets/392f4030/jquery.js"></script>
<script src="./assets/95ffbc2e/js/bootstrap.js"></script>
<script src="./assets/c312f280/jssearch.js"></script>    <title>数据库访问（Data Access Objects） - 配合数据库工作（Working with Databases） - The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w54" class="navbar-inverse navbar-fixed-top navbar"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w54-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">The Definitive Guide to Yii 2.0</a></div><div id="w54-collapse" class="collapse navbar-collapse"><ul id="w55" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Extensions <span class="caret"></span></a><ul id="w56" class="dropdown-menu"><li><a href="./ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="./ext-authclient-index.html" tabindex="-1">authclient</a></li>
<li><a href="./ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="./ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="./ext-elasticsearch-index.html" tabindex="-1">elasticsearch</a></li>
<li><a href="./ext-faker-index.html" tabindex="-1">faker</a></li>
<li><a href="./ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="./ext-httpclient-index.html" tabindex="-1">httpclient</a></li>
<li><a href="./ext-imagine-index.html" tabindex="-1">imagine</a></li>
<li><a href="./ext-jui-index.html" tabindex="-1">jui</a></li>
<li><a href="./ext-mongodb-index.html" tabindex="-1">mongodb</a></li>
<li><a href="./ext-redis-index.html" tabindex="-1">redis</a></li>
<li><a href="./ext-shell-index.html" tabindex="-1">shell</a></li>
<li><a href="./ext-smarty-index.html" tabindex="-1">smarty</a></li>
<li><a href="./ext-sphinx-index.html" tabindex="-1">sphinx</a></li>
<li><a href="./ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li>
<li><a href="./ext-twig-index.html" tabindex="-1">twig</a></li></ul></li>
<li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-38" data-toggle="collapse" data-parent="#navigation">介绍（Introduction） <b class="caret"></b></a><div id="navigation-38" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">关于 Yii（About Yii）</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">从 Yii 1.1 升级（Upgrading from Version 1.1）</a></div>
<a class="list-group-item" href="#navigation-39" data-toggle="collapse" data-parent="#navigation">入门（Getting Started） <b class="caret"></b></a><div id="navigation-39" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-prerequisites.html">你需要了解什么（What do you need to know）</a>
<a class="list-group-item" href="./guide-start-installation.html">安装 Yii（Installing Yii）</a>
<a class="list-group-item" href="./guide-start-workflow.html">运行应用（Running Applications）</a>
<a class="list-group-item" href="./guide-start-hello.html">第一次问候（Saying Hello）</a>
<a class="list-group-item" href="./guide-start-forms.html">使用 Forms（Working with Forms）</a>
<a class="list-group-item" href="./guide-start-databases.html">玩转 Databases（Working with Databases）</a>
<a class="list-group-item" href="./guide-start-gii.html">用 Gii 生成代码（Generating Code with Gii）</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">更上一层楼（Looking Ahead）</a></div>
<a class="list-group-item" href="#navigation-40" data-toggle="collapse" data-parent="#navigation">应用结构（Application Structure） <b class="caret"></b></a><div id="navigation-40" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-structure-overview.html">结构概述（Overview）</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">入口脚本（Entry Scripts）</a>
<a class="list-group-item" href="./guide-structure-applications.html">应用（Applications）</a>
<a class="list-group-item" href="./guide-structure-application-components.html">应用组件（Application Components）</a>
<a class="list-group-item" href="./guide-structure-controllers.html">控制器（Controllers）</a>
<a class="list-group-item" href="./guide-structure-models.html">模型（Models）</a>
<a class="list-group-item" href="./guide-structure-views.html">视图（Views）</a>
<a class="list-group-item" href="./guide-structure-modules.html">模块（Modules）</a>
<a class="list-group-item" href="./guide-structure-filters.html">过滤器（Filters）</a>
<a class="list-group-item" href="./guide-structure-widgets.html">小部件（Widgets）</a>
<a class="list-group-item" href="./guide-structure-assets.html">前端资源（Assets）</a>
<a class="list-group-item" href="./guide-structure-extensions.html">扩展（Extensions）</a></div>
<a class="list-group-item" href="#navigation-41" data-toggle="collapse" data-parent="#navigation">请求处理（Handling Requests） <b class="caret"></b></a><div id="navigation-41" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">运行概述（Overview）</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">引导（Bootstrapping）</a>
<a class="list-group-item" href="./guide-runtime-routing.html">路由引导与创建 URL（Routing and URL Creation）</a>
<a class="list-group-item" href="./guide-runtime-requests.html">请求（Requests）</a>
<a class="list-group-item" href="./guide-runtime-responses.html">响应（Responses）</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sessions and Cookies</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">错误处理（Handling Errors）</a>
<a class="list-group-item" href="./guide-runtime-logging.html">日志（Logging）</a></div>
<a class="list-group-item" href="#navigation-42" data-toggle="collapse" data-parent="#navigation">关键概念（Key Concepts） <b class="caret"></b></a><div id="navigation-42" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-concept-components.html">组件（Components）</a>
<a class="list-group-item" href="./guide-concept-properties.html">属性（Properties）</a>
<a class="list-group-item" href="./guide-concept-events.html">事件（Events）</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">行为（Behaviors）</a>
<a class="list-group-item" href="./guide-concept-configurations.html">配置（Configurations）</a>
<a class="list-group-item" href="./guide-concept-aliases.html">别名（Aliases）</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">类自动加载（Class Autoloading）</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">服务定位器（Service Locator）</a>
<a class="list-group-item" href="./guide-concept-di-container.html">依赖注入容器（Dependency Injection Container）</a></div>
<a class="list-group-item active" href="#navigation-43" data-toggle="collapse" data-parent="#navigation">配合数据库工作（Working with Databases） <b class="caret"></b></a><div id="navigation-43" class="submenu panel-collapse collapse in"><a class="list-group-item active" href="./guide-db-dao.html">数据库访问（Data Access Objects）</a>
<a class="list-group-item" href="./guide-db-query-builder.html">查询生成器（Query Builder）</a>
<a class="list-group-item" href="./guide-db-active-record.html">活动记录（Active Record）</a>
<a class="list-group-item" href="./guide-db-migrations.html">数据库迁移（Migrations）</a>
<a class="list-group-item" href="https://www.yiiframework.com/extension/yiisoft/yii2-sphinx/doc/guide">Sphinx</a>
<a class="list-group-item" href="https://www.yiiframework.com/extension/yiisoft/yii2-redis/doc/guide/2.0/zh-cn">Redis（yii2-redis）</a>
<a class="list-group-item" href="https://www.yiiframework.com/extension/yiisoft/yii2-mongodb/doc/guide">MongoDB</a>
<a class="list-group-item" href="https://www.yiiframework.com/extension/yiisoft/yii2-elasticsearch/doc/guide">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-44" data-toggle="collapse" data-parent="#navigation">接收用户数据（Getting Data from Users） <b class="caret"></b></a><div id="navigation-44" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">创建表单（Creating Forms）</a>
<a class="list-group-item" href="./guide-input-validation.html">输入验证（Validating Input）</a>
<a class="list-group-item" href="./guide-input-file-upload.html">文件上传（Uploading Files）</a>
<a class="list-group-item" href="./guide-input-tabular-input.html">收集列表输入（Collecting Tabular Input）</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">多模型同时输入（Getting Data for Multiple Models）</a>
<a class="list-group-item" href="./guide-input-form-javascript.html">在客户端扩展 ActiveForm（Extending ActiveForm on the Client Side）</a></div>
<a class="list-group-item" href="#navigation-45" data-toggle="collapse" data-parent="#navigation">显示数据（Displaying Data） <b class="caret"></b></a><div id="navigation-45" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatting.html">格式化输出数据（Data Formatting）</a>
<a class="list-group-item" href="./guide-output-pagination.html">分页（Pagination）</a>
<a class="list-group-item" href="./guide-output-sorting.html">排序（Sorting）</a>
<a class="list-group-item" href="./guide-output-data-providers.html">数据提供器（Data Providers）</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">数据小部件（Data Widgets）</a>
<a class="list-group-item" href="./guide-output-client-scripts.html">操作客户端脚本（Working with Client Scripts）</a>
<a class="list-group-item" href="./guide-output-theming.html">主题（Theming）</a></div>
<a class="list-group-item" href="#navigation-46" data-toggle="collapse" data-parent="#navigation">安全（Security） <b class="caret"></b></a><div id="navigation-46" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-overview.html">概述（Overview）</a>
<a class="list-group-item" href="./guide-security-authentication.html">认证（Authentication）</a>
<a class="list-group-item" href="./guide-security-authorization.html">授权（Authorization）</a>
<a class="list-group-item" href="./guide-security-passwords.html">处理密码（Working with Passwords）</a>
<a class="list-group-item" href="./guide-security-cryptography.html">加密（Cryptography）</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-authclient/blob/master/docs/guide-zh-CN/README.md">客户端认证（Auth Clients）</a>
<a class="list-group-item" href="./guide-security-best-practices.html">安全领域的最佳实践（Best Practices）</a></div>
<a class="list-group-item" href="#navigation-47" data-toggle="collapse" data-parent="#navigation">缓存（Caching） <b class="caret"></b></a><div id="navigation-47" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">概述（Overview）</a>
<a class="list-group-item" href="./guide-caching-data.html">数据缓存（Data Caching）</a>
<a class="list-group-item" href="./guide-caching-fragment.html">片段缓存（Fragment Caching）</a>
<a class="list-group-item" href="./guide-caching-page.html">页面缓存（Page Caching）</a>
<a class="list-group-item" href="./guide-caching-http.html">HTTP 缓存（HTTP Caching）</a></div>
<a class="list-group-item" href="#navigation-48" data-toggle="collapse" data-parent="#navigation">RESTful Web 服务（RESTful Web Services） <b class="caret"></b></a><div id="navigation-48" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">快速入门（Quick Start）</a>
<a class="list-group-item" href="./guide-rest-resources.html">资源（Resources）</a>
<a class="list-group-item" href="./guide-rest-controllers.html">控制器（Controllers）</a>
<a class="list-group-item" href="./guide-rest-routing.html">路由（Routing）</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">格式化响应（Response Formatting）</a>
<a class="list-group-item" href="./guide-rest-authentication.html">授权验证（Authentication）</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">速率限制（Rate Limiting）</a>
<a class="list-group-item" href="./guide-rest-versioning.html">版本化（Versioning）</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">错误处理（Error Handling）</a></div>
<a class="list-group-item" href="#navigation-49" data-toggle="collapse" data-parent="#navigation">开发工具（Development Tools） <b class="caret"></b></a><div id="navigation-49" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide-zh-CN/README.md">调试工具栏和调试器（Debug Toolbar and Debugger）</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-gii/blob/master/docs/guide-zh-CN/README.md">使用 Gii 生成代码（Generating Code using Gii）</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-apidoc">生成 API 文档（Generating API Documentation）</a></div>
<a class="list-group-item" href="#navigation-50" data-toggle="collapse" data-parent="#navigation">测试（Testing） <b class="caret"></b></a><div id="navigation-50" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">概述（Overview）</a>
<a class="list-group-item" href="./guide-test-environment-setup.html">搭建测试环境（Testing environment setup）</a>
<a class="list-group-item" href="./guide-test-unit.html">单元测试（Unit Tests）</a>
<a class="list-group-item" href="./guide-test-functional.html">功能测试（Functional Tests）</a>
<a class="list-group-item" href="./guide-test-acceptance.html">验收测试（Acceptance Tests）</a>
<a class="list-group-item" href="./guide-test-fixtures.html">测试夹具（Fixtures）</a></div>
<a class="list-group-item" href="#navigation-51" data-toggle="collapse" data-parent="#navigation">高级专题（Special Topics） <b class="caret"></b></a><div id="navigation-51" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-app-advanced/blob/master/docs/guide-zh-CN/README.md">高级应用模版（Advanced Project Template）</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">从头构建自定义模版（Building Application from Scratch）</a>
<a class="list-group-item" href="./guide-tutorial-console.html">控制台命令（Console Commands）</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">核心验证器（Core Validators）</a>
<a class="list-group-item" href="./guide-tutorial-docker.html">Docker</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">国际化（Internationalization）</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">收发邮件（Mailing）</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">性能优化（Performance Tuning）</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">共享主机环境（Shared Hosting Environment）</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">模板引擎（Template Engines）</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">集成第三方代码（Working with Third-Party Code）</a>
<a class="list-group-item" href="./guide-tutorial-yii-as-micro-framework.html">使用 Yii 作为微框架（Using Yii as a micro framework）</a></div>
<a class="list-group-item" href="#navigation-52" data-toggle="collapse" data-parent="#navigation">小部件（Widgets） <b class="caret"></b></a><div id="navigation-52" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-grid-gridview.html">GridView</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-listview.html">ListView</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-detailview.html">DetailView</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/guide-input-forms.html#activerecord-based-forms-activeform">ActiveForm</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-pjax.html">Pjax</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-menu.html">Menu</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-linkpager.html">LinkPager</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-linksorter.html">LinkSorter</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-bootstrap/blob/master/docs/guide-zh-CN/README.md">Bootstrap Widgets</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-jui/blob/master/docs/guide-zh-CN/README.md">jQuery UI Widgets</a></div>
<a class="list-group-item" href="#navigation-53" data-toggle="collapse" data-parent="#navigation">助手类（Helpers） <b class="caret"></b></a><div id="navigation-53" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">助手一览（Overview）</a>
<a class="list-group-item" href="./guide-helper-array.html">Array 助手（ArrayHelper）</a>
<a class="list-group-item" href="./guide-helper-html.html">Html 助手（Html）</a>
<a class="list-group-item" href="./guide-helper-url.html">Url 助手（Url）</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><h1>&#25968;&#25454;&#24211;&#35775;&#38382;&#23545;&#35937;&#65288;Database Access Objects&#65289; <span id="shu-ju-ku-fang-wen-dui-xiang-database-access-objects"></span><a href="#shu-ju-ku-fang-wen-dui-xiang-database-access-objects" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#creating-db-connections">&#21019;&#24314;&#25968;&#25454;&#24211;&#36830;&#25509;&#65288;Creating DB Connections&#65289;</a></li>
<li><a href="#executing-sql-queries">&#25191;&#34892; SQL &#26597;&#35810;&#65288;Executing SQL Queries&#65289;</a></li>
<li><a href="#quoting-table-and-column-names">&#24341;&#29992;&#34920;&#21644;&#21015;&#21517;&#31216;&#65288;Quoting Table and Column Names&#65289;</a></li>
<li><a href="#performing-transactions">&#25191;&#34892;&#20107;&#21153;&#65288;Performing Transactions&#65289;</a></li>
<li><a href="#read-write-splitting">&#22797;&#21046;&#21644;&#35835;&#20889;&#20998;&#31163;&#65288;Replication and Read-Write Splitting&#65289;</a></li>
<li><a href="#database-schema">&#25805;&#32437;&#25968;&#25454;&#24211;&#27169;&#24335;&#65288;Working with Database Schema&#65289;</a></li></ol></div>
<p>Yii &#21253;&#21547;&#20102;&#19968;&#20010;&#24314;&#31435;&#22312; PHP PDO &#20043;&#19978;&#30340;&#25968;&#25454;&#35775;&#38382;&#23618; (DAO)&#12290;DAO&#20026;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#25552;&#20379;&#20102;&#19968;&#22871;&#32479;&#19968;&#30340;API&#12290;
&#20854;&#20013; <code>ActiveRecord</code> &#25552;&#20379;&#20102;&#25968;&#25454;&#24211;&#19982;&#27169;&#22411;(MVC &#20013;&#30340; M,Model) &#30340;&#20132;&#20114;&#65292;<code>QueryBuilder</code> &#29992;&#20110;&#21019;&#24314;&#21160;&#24577;&#30340;&#26597;&#35810;&#35821;&#21477;&#12290;
DAO&#25552;&#20379;&#20102;&#31616;&#21333;&#39640;&#25928;&#30340;SQL&#26597;&#35810;&#65292;&#21487;&#20197;&#29992;&#22312;&#19982;&#25968;&#25454;&#24211;&#20132;&#20114;&#30340;&#21508;&#20010;&#22320;&#26041;.</p>
<p>&#20351;&#29992; Yii DAO &#26102;&#65292;&#20320;&#20027;&#35201;&#38656;&#35201;&#22788;&#29702;&#32431; SQL &#35821;&#21477;&#21644; PHP &#25968;&#32452;&#12290;&#22240;&#27492;&#65292;&#36825;&#26159;&#35775;&#38382;&#25968;&#25454;&#24211;&#26368;&#39640;&#25928;&#30340;&#26041;&#27861;&#12290;
&#28982;&#32780;&#65292;&#22240;&#20026;&#19981;&#21516;&#25968;&#25454;&#24211;&#20043;&#38388;&#30340; SQL &#35821;&#27861;&#24448;&#24448;&#26159;&#19981;&#21516;&#30340;&#65292;
&#20351;&#29992; Yii DAO &#20063;&#24847;&#21619;&#30528;&#20320;&#24517;&#39035;&#33457;&#20123;&#39069;&#22806;&#30340;&#24037;&#22827;&#26469;&#21019;&#24314;&#19968;&#20010;&rdquo;&#25968;&#25454;&#24211;&#26080;&#20851;&ldquo;&#30340;&#24212;&#29992;&#12290;</p>
<p>Yii DAO &#25903;&#25345;&#19979;&#21015;&#29616;&#25104;&#30340;&#25968;&#25454;&#24211;&#65306;</p>
<ul>
<li><a href="https://www.mysql.com/">MySQL</a></li>
<li><a href="https://mariadb.com/">MariaDB</a></li>
<li><a href="https://sqlite.org/">SQLite</a></li>
<li><a href="https://www.postgresql.org/">PostgreSQL</a>&#65306;&#29256;&#26412; 8.4 &#25110;&#26356;&#39640;</li>
<li><a href="https://www.cubrid.org/">CUBRID</a>&#65306;&#29256;&#26412; 9.3 &#25110;&#26356;&#39640;&#12290;</li>
<li><a href="https://www.oracle.com/database/">Oracle</a></li>
<li><a href="https://www.microsoft.com/en-us/sqlserver/default.aspx">MSSQL</a>&#65306;&#29256;&#26412; 2008 &#25110;&#26356;&#39640;&#12290;</li>
</ul>
<blockquote class="info"><p><strong>&#20449;&#24687;&#65306; </strong>&#22312;Yii 2.1&#21450;&#26356;&#39640;&#29256;&#26412;&#20013;&#65292;DAO &#25903;&#25345; CUBRID&#65292;Oracle &#21644; MSSQL
  &#19981;&#20877;&#20316;&#20026;&#26694;&#26550;&#30340;&#20869;&#32622;&#26680;&#24515;&#32452;&#20214;&#25552;&#20379;&#12290;&#23427;&#20204;&#24517;&#39035;&#20316;&#20026;&#29420;&#31163;&#30340; <a href="guide-structure-extensions.html">&#25193;&#23637;</a> &#23433;&#35013;&#12290;
  <a href="https://www.yiiframework.com/extension/yiisoft/yii2-oracle">yiisoft/yii2-oracle</a> &#21644;
  <a href="https://www.yiiframework.com/extension/yiisoft/yii2-mssql">yiisoft/yii2-mssql</a> &#37117;&#23646;&#20110;
  <a href="https://www.yiiframework.com/extensions/official">&#23448;&#26041;&#25193;&#23637;</a>&#12290;</p>
</blockquote>
<blockquote class="note"><p><strong>&#27880;&#24847;&#65306; </strong>&#20379; PHP 7 &#20351;&#29992;&#30340;&#26032;&#29256; pdo_oci &#25193;&#23637;&#30446;&#21069;&#20165;&#21457;&#24067;&#20102;&#28304;&#20195;&#30721;&#65292;&#22914;&#26524;&#20320;&#24819;&#32534;&#35793;&#20351;&#29992;&#35831;&#21442;&#29031; 
  <a href="https://github.com/yiisoft/yii2/issues/10975#issuecomment-248479268">&#31038;&#21306;&#29992;&#25143;&#25552;&#20379;&#30340;&#32534;&#35793;&#23433;&#35013;&#25351;&#24341;</a>&#12290;
  &#25110;&#32773;&#20320;&#20063;&#21487;&#20197;&#22312;&#20320;&#30340;&#24212;&#29992;&#20013;&#20351;&#29992; <a href="https://github.com/taq/pdooci">PDO&#27169;&#25311;&#23618;</a>&#12290;</p>
</blockquote>
<h2>&#21019;&#24314;&#25968;&#25454;&#24211;&#36830;&#25509;&#65288;Creating DB Connections&#65289;  <span id="creating-db-connections"></span><a href="#creating-db-connections" class="hashlink">&para;</a></h2><p>&#24819;&#35201;&#35775;&#38382;&#25968;&#25454;&#24211;&#65292;&#20320;&#39318;&#20808;&#38656;&#35201;&#36890;&#36807;&#21019;&#24314;&#19968;&#20010; <a href="./yii-db-connection.html">yii\db\Connection</a> &#23454;&#20363;&#26469;&#19982;&#20043;&#24314;&#31435;&#36830;&#25509;&#12290;</p>
<pre><code class="hljs php language-php">$db = <span class="hljs-keyword">new</span> yii\db\Connection([
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'mysql:host=localhost;dbname=example'</span>,
    <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
    <span class="hljs-string">'charset'</span> =&gt; <span class="hljs-string">'utf8'</span>,
]);
</code></pre>
<p>&#22240;&#20026;&#25968;&#25454;&#24211;&#36830;&#25509;&#32463;&#24120;&#38656;&#35201;&#22312;&#22810;&#20010;&#22320;&#26041;&#20351;&#29992;&#21040;&#65292;
&#19968;&#20010;&#24120;&#35265;&#30340;&#20570;&#27861;&#26159;&#20197;<a href="guide-structure-application-components.html">&#24212;&#29992;&#32452;&#20214;</a>&#30340;&#26041;&#24335;&#26469;&#37197;&#32622;&#23427;&#65292;&#22914;&#19979;:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-comment">// ...</span>
        <span class="hljs-string">'db'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\db\Connection'</span>,
            <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'mysql:host=localhost;dbname=example'</span>,
            <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
            <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
            <span class="hljs-string">'charset'</span> =&gt; <span class="hljs-string">'utf8'</span>,
        ],
    ],
    <span class="hljs-comment">// ...</span>
];
</code></pre>
<p>&#20043;&#21518;&#20320;&#23601;&#21487;&#20197;&#36890;&#36807;&#35821;&#21477; <code>Yii::$app-&gt;db</code> &#26469;&#20351;&#29992;&#25968;&#25454;&#24211;&#36830;&#25509;&#20102;&#12290;</p>
<blockquote class="tip"><p><strong>&#25552;&#31034;&#65306; </strong>&#22914;&#26524;&#20320;&#30340;&#24212;&#29992;&#38656;&#35201;&#35775;&#38382;&#22810;&#20010;&#25968;&#25454;&#24211;&#65292;&#20320;&#21487;&#20197;&#37197;&#32622;&#22810;&#20010; DB &#24212;&#29992;&#32452;&#20214;&#12290;</p>
</blockquote>
<p>&#37197;&#32622;&#25968;&#25454;&#24211;&#36830;&#25509;&#26102;&#65292; &#20320;&#24212;&#35813;&#24635;&#26159;&#36890;&#36807; <a href="./yii-db-connection.html#%24dsn-detail">dsn</a> &#23646;&#24615;&#26469;&#25351;&#26126;&#23427;&#30340;&#25968;&#25454;&#28304;&#21517;&#31216; (DSN) &#12290;
&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#26377;&#30528;&#19981;&#21516;&#30340; DSN &#26684;&#24335;&#12290;
&#35831;&#21442;&#32771; <a href="https://www.php.net/manual/zh/pdo.construct.php">PHP manual</a> &#26469;&#33719;&#24471;&#26356;&#22810;&#32454;&#33410;&#12290;&#19979;&#38754;&#26159;&#19968;&#20123;&#20363;&#23376;&#65306;</p>
<ul>
<li>MySQL, MariaDB: <code>mysql:host=localhost;dbname=mydatabase</code></li>
<li>SQLite: <code>sqlite:/path/to/database/file</code></li>
<li>PostgreSQL: <code>pgsql:host=localhost;port=5432;dbname=mydatabase</code></li>
<li>CUBRID: <code>cubrid:dbname=demodb;host=localhost;port=33000</code></li>
<li>MS SQL Server (via sqlsrv driver): <code>sqlsrv:Server=localhost;Database=mydatabase</code></li>
<li>MS SQL Server (via dblib driver): <code>dblib:host=localhost;dbname=mydatabase</code></li>
<li>MS SQL Server (via mssql driver): <code>mssql:host=localhost;dbname=mydatabase</code></li>
<li>Oracle: <code>oci:dbname=//localhost:1521/mydatabase</code></li>
</ul>
<p>&#35831;&#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#26159;&#36890;&#36807; ODBC &#26469;&#36830;&#25509;&#25968;&#25454;&#24211;&#65292;&#20320;&#24212;&#35813;&#37197;&#32622; <a href="./yii-db-connection.html#%24driverName-detail">yii\db\Connection::$driverName</a> &#23646;&#24615;&#65292;
&#20197;&#20415; Yii &#33021;&#22815;&#30693;&#36947;&#23454;&#38469;&#30340;&#25968;&#25454;&#24211;&#31181;&#31867;&#12290;&#20363;&#22914;&#65306;</p>
<pre><code class="hljs php language-php"><span class="hljs-string">'db'</span> =&gt; [
    <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\db\Connection'</span>,
    <span class="hljs-string">'driverName'</span> =&gt; <span class="hljs-string">'mysql'</span>,
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'odbc:Driver={MySQL};Server=localhost;Database=test'</span>,
    <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'root'</span>,
    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
],
</code></pre>
<p>&#38500;&#20102; <a href="./yii-db-connection.html#%24dsn-detail">dsn</a> &#23646;&#24615;&#65292;
&#20320;&#24120;&#24120;&#38656;&#35201;&#37197;&#32622; <a href="./yii-db-connection.html#%24username-detail">username</a> &#21644; <a href="./yii-db-connection.html#%24password-detail">password</a>&#12290;&#35831;&#21442;&#32771; <a href="./yii-db-connection.html">yii\db\Connection</a> &#26469;&#33719;&#21462;&#23436;&#25972;&#30340;&#21487;&#37197;&#32622;&#23646;&#24615;&#21015;&#34920;&#12290;</p>
<blockquote class="info"><p><strong>&#20449;&#24687;&#65306; </strong>&#24403;&#20320;&#23454;&#20363;&#21270;&#19968;&#20010; DB Connection &#26102;&#65292;&#30452;&#21040;&#20320;&#31532;&#19968;&#27425;&#25191;&#34892; SQL &#25110;&#32773;&#20320;&#26126;&#30830;&#22320;&#35843;&#29992; <a href="./yii-db-connection.html#open()-detail">open()</a> &#26041;&#27861;&#26102;&#65292;
  &#25165;&#24314;&#31435;&#36215;&#23454;&#38469;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#12290;</p>
</blockquote>
<blockquote class="tip"><p><strong>&#25552;&#31034;&#65306; </strong>&#26377;&#26102;&#20320;&#21487;&#33021;&#24819;&#35201;&#22312;&#24314;&#31435;&#36215;&#25968;&#25454;&#24211;&#36830;&#25509;&#26102;&#31435;&#21363;&#25191;&#34892;&#19968;&#20123;&#35821;&#21477;&#26469;&#21021;&#22987;&#21270;&#19968;&#20123;&#29615;&#22659;&#21464;&#37327; (&#27604;&#22914;&#35774;&#32622;&#26102;&#21306;&#25110;&#32773;&#23383;&#31526;&#38598;),
&#20320;&#21487;&#20197;&#36890;&#36807;&#20026;&#25968;&#25454;&#24211;&#36830;&#25509;&#30340; <a href="./yii-db-connection.html#EVENT_AFTER_OPEN-detail">afterOpen</a> 
&#20107;&#20214;&#27880;&#20876;&#19968;&#20010;&#20107;&#20214;&#22788;&#29702;&#22120;&#26469;&#36798;&#21040;&#30446;&#30340;&#12290;
&#20320;&#21487;&#20197;&#20687;&#36825;&#26679;&#30452;&#25509;&#22312;&#24212;&#29992;&#37197;&#32622;&#20013;&#27880;&#20876;&#22788;&#29702;&#22120;&#65306;</p>
<pre><code class="hljs php language-php"><span class="hljs-string">'db'</span> =&gt; [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'on afterOpen'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($event)</span> </span>{
        <span class="hljs-comment">// $event-&gt;sender refers to the DB connection</span>
        $event-&gt;sender-&gt;createCommand(<span class="hljs-string">"SET time_zone = 'UTC'"</span>)-&gt;execute();
    }
],
</code></pre>
</blockquote>
<h2>&#25191;&#34892; SQL &#26597;&#35810;&#65288;Executing SQL Queries&#65289;  <span id="executing-sql-queries"></span><a href="#executing-sql-queries" class="hashlink">&para;</a></h2><p>&#19968;&#26086;&#20320;&#25317;&#26377;&#20102; DB Connection &#23454;&#20363;&#65292;&#20320;&#21487;&#20197;&#25353;&#29031;&#19979;&#21015;&#27493;&#39588;&#26469;&#25191;&#34892; SQL &#26597;&#35810;&#65306;</p>
<ol>
<li>&#20351;&#29992;&#32431;SQL&#26597;&#35810;&#26469;&#21019;&#24314;&#20986; <a href="./yii-db-command.html">yii\db\Command</a>&#65307;</li>
<li>&#32465;&#23450;&#21442;&#25968; (&#21487;&#36873;&#30340;)&#65307;</li>
<li>&#35843;&#29992; <a href="./yii-db-command.html">yii\db\Command</a> &#37324; SQL &#25191;&#34892;&#26041;&#27861;&#20013;&#30340;&#19968;&#20010;&#12290;</li>
</ol>
<p>&#19979;&#21015;&#20363;&#23376;&#23637;&#31034;&#20102;&#20960;&#31181;&#19981;&#21516;&#30340;&#20174;&#25968;&#25454;&#24211;&#21462;&#24471;&#25968;&#25454;&#30340;&#26041;&#27861;&#65306;</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// &#36820;&#22238;&#22810;&#34892;. &#27599;&#34892;&#37117;&#26159;&#21015;&#21517;&#21644;&#20540;&#30340;&#20851;&#32852;&#25968;&#32452;.</span>
<span class="hljs-comment">// &#22914;&#26524;&#35813;&#26597;&#35810;&#27809;&#26377;&#32467;&#26524;&#21017;&#36820;&#22238;&#31354;&#25968;&#32452;</span>
$posts = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post'</span>)
            -&gt;queryAll();

<span class="hljs-comment">// &#36820;&#22238;&#19968;&#34892; (&#31532;&#19968;&#34892;)</span>
<span class="hljs-comment">// &#22914;&#26524;&#35813;&#26597;&#35810;&#27809;&#26377;&#32467;&#26524;&#21017;&#36820;&#22238; false</span>
$post = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post WHERE id=1'</span>)
           -&gt;queryOne();

<span class="hljs-comment">// &#36820;&#22238;&#19968;&#21015; (&#31532;&#19968;&#21015;)</span>
<span class="hljs-comment">// &#22914;&#26524;&#35813;&#26597;&#35810;&#27809;&#26377;&#32467;&#26524;&#21017;&#36820;&#22238;&#31354;&#25968;&#32452;</span>
$titles = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT title FROM post'</span>)
             -&gt;queryColumn();

<span class="hljs-comment">// &#36820;&#22238;&#19968;&#20010;&#26631;&#37327;&#20540;</span>
<span class="hljs-comment">// &#22914;&#26524;&#35813;&#26597;&#35810;&#27809;&#26377;&#32467;&#26524;&#21017;&#36820;&#22238; false</span>
$count = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT COUNT(*) FROM post'</span>)
             -&gt;queryScalar();
</code></pre>
<blockquote class="note"><p><strong>&#27880;&#24847;&#65306; </strong>&#20026;&#20102;&#20445;&#25345;&#31934;&#24230;&#65292;&#21363;&#20351;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#21015;&#31867;&#22411;&#20026;&#25968;&#20540;&#22411;&#65292;
&#25152;&#26377;&#20174;&#25968;&#25454;&#24211;&#21462;&#24471;&#30340;&#25968;&#25454;&#37117;&#34987;&#34920;&#29616;&#20026;&#23383;&#31526;&#20018;&#12290;</p>
</blockquote>
<h3>&#32465;&#23450;&#21442;&#25968;&#65288;Binding Parameters&#65289;  <span id="binding-parameters"></span><a href="#binding-parameters" class="hashlink">&para;</a></h3><p>&#24403;&#20351;&#29992;&#24102;&#21442;&#25968;&#30340; SQL &#26469;&#21019;&#24314;&#25968;&#25454;&#24211;&#21629;&#20196;&#26102;&#65292;
&#20320;&#20960;&#20046;&#24635;&#26159;&#24212;&#35813;&#20351;&#29992;&#32465;&#23450;&#21442;&#25968;&#30340;&#26041;&#27861;&#26469;&#38450;&#27490; SQL &#27880;&#20837;&#25915;&#20987;&#65292;&#20363;&#22914;&#65306;</p>
<pre><code class="hljs php language-php">$post = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post WHERE id=:id AND status=:status'</span>)
           -&gt;bindValue(<span class="hljs-string">':id'</span>, $_GET[<span class="hljs-string">'id'</span>])
           -&gt;bindValue(<span class="hljs-string">':status'</span>, <span class="hljs-number">1</span>)
           -&gt;queryOne();
</code></pre>
<p>&#22312; SQL &#35821;&#21477;&#20013;&#65292;&#20320;&#21487;&#20197;&#23884;&#20837;&#19968;&#20010;&#25110;&#22810;&#20010;&#21442;&#25968;&#21344;&#20301;&#31526;(&#20363;&#22914;&#65292;&#19978;&#36848;&#20363;&#23376;&#20013;&#30340; <code>:id</code> )&#12290; 
&#19968;&#20010;&#21442;&#25968;&#21344;&#20301;&#31526;&#24212;&#35813;&#26159;&#20197;&#20882;&#21495;&#24320;&#22836;&#30340;&#23383;&#31526;&#20018;&#12290;
&#20043;&#21518;&#20320;&#21487;&#20197;&#35843;&#29992;&#19979;&#38754;&#32465;&#23450;&#21442;&#25968;&#30340;&#26041;&#27861;&#26469;&#32465;&#23450;&#21442;&#25968;&#20540;&#65306;</p>
<ul>
<li><a href="./yii-db-command.html#bindValue()-detail">bindValue()</a>&#65306;&#32465;&#23450;&#19968;&#20010;&#21442;&#25968;&#20540;</li>
<li><a href="./yii-db-command.html#bindValues()-detail">bindValues()</a>&#65306;&#22312;&#19968;&#27425;&#35843;&#29992;&#20013;&#32465;&#23450;&#22810;&#20010;&#21442;&#25968;&#20540;</li>
<li><a href="./yii-db-command.html#bindParam()-detail">bindParam()</a>&#65306;&#19982; <a href="./yii-db-command.html#bindValue()-detail">bindValue()</a>
&#30456;&#20284;&#65292;&#20294;&#26159;&#20063;&#25903;&#25345;&#32465;&#23450;&#21442;&#25968;&#24341;&#29992;&#12290;</li>
</ul>
<p>&#19979;&#38754;&#30340;&#20363;&#23376;&#23637;&#31034;&#20102;&#20960;&#20010;&#21487;&#20379;&#36873;&#25321;&#30340;&#32465;&#23450;&#21442;&#25968;&#30340;&#26041;&#27861;&#65306;</p>
<pre><code class="hljs php language-php">$params = [<span class="hljs-string">':id'</span> =&gt; $_GET[<span class="hljs-string">'id'</span>], <span class="hljs-string">':status'</span> =&gt; <span class="hljs-number">1</span>];

$post = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post WHERE id=:id AND status=:status'</span>)
           -&gt;bindValues($params)
           -&gt;queryOne();
           
$post = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post WHERE id=:id AND status=:status'</span>, $params)
           -&gt;queryOne();
</code></pre>
<p>&#32465;&#23450;&#21442;&#25968;&#26159;&#36890;&#36807; <a href="https://www.php.net/manual/zh/mysqli.quickstart.prepared-statements.php">&#39044;&#22788;&#29702;&#35821;&#21477;</a> &#23454;&#29616;&#30340;&#12290;
&#38500;&#20102;&#38450;&#27490; SQL &#27880;&#20837;&#25915;&#20987;&#65292;&#23427;&#20063;&#21487;&#20197;&#36890;&#36807;&#19968;&#27425;&#39044;&#22788;&#29702; SQL &#35821;&#21477;&#65292;
&#20351;&#29992;&#19981;&#21516;&#21442;&#25968;&#22810;&#27425;&#25191;&#34892;&#65292;&#26469;&#25552;&#21319;&#24615;&#33021;&#12290;&#20363;&#22914;&#65306;</p>
<pre><code class="hljs php language-php">$command = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post WHERE id=:id'</span>);

$post1 = $command-&gt;bindValue(<span class="hljs-string">':id'</span>, <span class="hljs-number">1</span>)-&gt;queryOne();
$post2 = $command-&gt;bindValue(<span class="hljs-string">':id'</span>, <span class="hljs-number">2</span>)-&gt;queryOne();
<span class="hljs-comment">// ...</span>
</code></pre>
<p>&#22240;&#20026; <a href="./yii-db-command.html#bindParam()-detail">bindParam()</a> &#25903;&#25345;&#36890;&#36807;&#24341;&#29992;&#26469;&#32465;&#23450;&#21442;&#25968;&#65292;
&#19978;&#36848;&#20195;&#30721;&#20063;&#21487;&#20197;&#20687;&#19979;&#38754;&#36825;&#26679;&#20889;&#65306;</p>
<pre><code class="hljs php language-php">$command = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM post WHERE id=:id'</span>)
              -&gt;bindParam(<span class="hljs-string">':id'</span>, $id);

$id = <span class="hljs-number">1</span>;
$post1 = $command-&gt;queryOne();

$id = <span class="hljs-number">2</span>;
$post2 = $command-&gt;queryOne();
<span class="hljs-comment">// ...</span>
</code></pre>
<p>&#35831;&#27880;&#24847;&#65292;&#22312;&#25191;&#34892;&#35821;&#21477;&#21069;&#20320;&#23558;&#21344;&#20301;&#31526;&#32465;&#23450;&#21040; <code>$id</code> &#21464;&#37327;&#65292;
&#28982;&#21518;&#22312;&#20043;&#21518;&#30340;&#27599;&#27425;&#25191;&#34892;&#21069;&#25913;&#21464;&#21464;&#37327;&#30340;&#20540;&#65288;&#36825;&#36890;&#24120;&#26159;&#29992;&#24490;&#29615;&#26469;&#23436;&#25104;&#30340;&#65289;&#12290;
&#20197;&#36825;&#31181;&#26041;&#24335;&#25191;&#34892;&#26597;&#35810;&#27604;&#20026;&#27599;&#20010;&#19981;&#21516;&#30340;&#21442;&#25968;&#20540;&#25191;&#34892;&#19968;&#27425;&#26032;&#30340;&#26597;&#35810;&#35201;&#39640;&#25928;&#24471;&#22810;&#24471;&#22810;&#12290;</p>
<blockquote class="info"><p><strong>&#20449;&#24687;&#65306; </strong>&#21442;&#25968;&#32465;&#23450;&#20165;&#29992;&#20110;&#38656;&#35201;&#23558;&#20540;&#25554;&#20837;&#21040;&#21253;&#21547;&#26222;&#36890;SQL&#30340;&#23383;&#31526;&#20018;&#20013;&#30340;&#22320;&#26041;&#12290;
&#22312;&nbsp;<a href="guide-db-query-builder.html">Query Builder</a> &#21644;&nbsp;<a href="guide-db-active-record.html">Active Record</a>
&#31561;&#26356;&#39640;&#25277;&#35937;&#23618;&#30340;&#35768;&#22810;&#22320;&#26041;&#65292;&#24744;&#32463;&#24120;&#20250;&#25351;&#23450;&#19968;&#32452;&#23558;&#34987;&#36716;&#25442;&#20026; SQL &#30340;&#20540;&#12290;
&#22312;&#36825;&#20123;&#22320;&#26041;&#65292;&#21442;&#25968;&#32465;&#23450;&#26159;&#30001; Yii &#20869;&#37096;&#23436;&#25104;&#30340;&#65292;&#22240;&#27492;&#19981;&#38656;&#35201;&#25163;&#21160;&#25351;&#23450;&#21442;&#25968;&#12290;</p>
</blockquote>
<h3>&#25191;&#34892;&#38750;&#26597;&#35810;&#35821;&#21477;&#65288;Executing Non-SELECT Queries&#65289;  <span id="non-select-queries"></span><a href="#non-select-queries" class="hashlink">&para;</a></h3><p>&#19978;&#38754;&#37096;&#20998;&#20013;&#20171;&#32461;&#30340; <code>queryXyz()</code> &#26041;&#27861;&#37117;&#22788;&#29702;&#30340;&#26159;&#20174;&#25968;&#25454;&#24211;&#36820;&#22238;&#25968;&#25454;&#30340;&#26597;&#35810;&#35821;&#21477;&#12290;&#23545;&#20110;&#37027;&#20123;&#19981;&#21462;&#22238;&#25968;&#25454;&#30340;&#35821;&#21477;&#65292;
&#20320;&#24212;&#35813;&#35843;&#29992;&#30340;&#26159; <a href="./yii-db-command.html#execute()-detail">yii\db\Command::execute()</a> &#26041;&#27861;&#12290;&#20363;&#22914;&#65292;</p>
<pre><code class="hljs php language-php">Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'UPDATE post SET status=1 WHERE id=1'</span>)
   -&gt;execute();
</code></pre>
<p><a href="./yii-db-command.html#execute()-detail">yii\db\Command::execute()</a> &#26041;&#27861;&#36820;&#22238;&#25191;&#34892; SQL &#25152;&#24433;&#21709;&#21040;&#30340;&#34892;&#25968;&#12290;</p>
<p>&#23545;&#20110; INSERT, UPDATE &#21644; DELETE &#35821;&#21477;&#65292;&#19981;&#20877;&#38656;&#35201;&#20889;&#32431;SQL&#35821;&#21477;&#20102;&#65292; 
&#20320;&#21487;&#20197;&#30452;&#25509;&#35843;&#29992; <a href="./yii-db-command.html#insert()-detail">insert()</a>&#12289;<a href="./yii-db-command.html#update()-detail">update()</a>&#12289;<a href="./yii-db-command.html#delete()-detail">delete()</a>&#65292;
&#26469;&#26500;&#24314;&#30456;&#24212;&#30340; SQL &#35821;&#21477;&#12290;&#36825;&#20123;&#26041;&#27861;&#23558;&#27491;&#30830;&#22320;&#24341;&#29992;&#34920;&#21644;&#21015;&#21517;&#31216;&#20197;&#21450;&#32465;&#23450;&#21442;&#25968;&#20540;&#12290;&#20363;&#22914;,</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// INSERT (table name, column values)</span>
Yii::$app-&gt;db-&gt;createCommand()-&gt;insert(<span class="hljs-string">'user'</span>, [
    <span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Sam'</span>,
    <span class="hljs-string">'age'</span> =&gt; <span class="hljs-number">30</span>,
])-&gt;execute();

<span class="hljs-comment">// UPDATE (table name, column values, condition)</span>
Yii::$app-&gt;db-&gt;createCommand()-&gt;update(<span class="hljs-string">'user'</span>, [<span class="hljs-string">'status'</span> =&gt; <span class="hljs-number">1</span>], <span class="hljs-string">'age &gt; 30'</span>)-&gt;execute();

<span class="hljs-comment">// DELETE (table name, condition)</span>
Yii::$app-&gt;db-&gt;createCommand()-&gt;delete(<span class="hljs-string">'user'</span>, <span class="hljs-string">'status = 0'</span>)-&gt;execute();
</code></pre>
<p>&#20320;&#20063;&#21487;&#20197;&#35843;&#29992; <a href="./yii-db-command.html#batchInsert()-detail">batchInsert()</a> &#26469;&#19968;&#27425;&#25554;&#20837;&#22810;&#34892;&#65292;
&#36825;&#27604;&#19968;&#27425;&#25554;&#20837;&#19968;&#34892;&#35201;&#39640;&#25928;&#24471;&#22810;&#65306;</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// table name, column names, column values</span>
Yii::$app-&gt;db-&gt;createCommand()-&gt;batchInsert(<span class="hljs-string">'user'</span>, [<span class="hljs-string">'name'</span>, <span class="hljs-string">'age'</span>], [
    [<span class="hljs-string">'Tom'</span>, <span class="hljs-number">30</span>],
    [<span class="hljs-string">'Jane'</span>, <span class="hljs-number">20</span>],
    [<span class="hljs-string">'Linda'</span>, <span class="hljs-number">25</span>],
])-&gt;execute();
</code></pre>
<p>&#21478;&#19968;&#20010;&#26377;&#29992;&#30340;&#26041;&#27861;&#26159; <a href="./yii-db-command.html#upsert()-detail">upsert()</a>&#12290;Upsert &#26159;&#19968;&#31181;&#21407;&#23376;&#25805;&#20316;&#65292;&#22914;&#26524;&#23427;&#20204;&#19981;&#23384;&#22312;&#65288;&#21305;&#37197;&#21807;&#19968;&#32422;&#26463;&#65289;&#65292;&#21017;&#23558;&#34892;&#25554;&#20837;&#21040;&#25968;&#25454;&#24211;&#34920;&#20013;&#65292;
&#25110;&#32773;&#22312;&#23427;&#20204;&#25191;&#34892;&#26102;&#26356;&#26032;&#23427;&#20204;&#65306;</p>
<pre><code class="hljs php language-php">Yii::$app-&gt;db-&gt;createCommand()-&gt;upsert(<span class="hljs-string">'pages'</span>, [
    <span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Front page'</span>,
    <span class="hljs-string">'url'</span> =&gt; <span class="hljs-string">'https://example.com/'</span>, <span class="hljs-comment">// url is unique</span>
    <span class="hljs-string">'visits'</span> =&gt; <span class="hljs-number">0</span>,
], [
    <span class="hljs-string">'visits'</span> =&gt; <span class="hljs-keyword">new</span> \yii\db\Expression(<span class="hljs-string">'visits + 1'</span>),
], $params)-&gt;execute();
</code></pre>
<p>&#19978;&#38754;&#30340;&#20195;&#30721;&#23558;&#25554;&#20837;&#19968;&#20010;&#26032;&#30340;&#39029;&#38754;&#35760;&#24405;&#25110;&#33258;&#21160;&#22686;&#21152;&#35775;&#38382;&#35745;&#25968;&#22120;&#12290;</p>
<p>&#35831;&#27880;&#24847;&#65292;&#19978;&#36848;&#30340;&#26041;&#27861;&#21482;&#26159;&#26500;&#24314;&#20986;&#35821;&#21477;&#65292;
&#20320;&#24635;&#26159;&#38656;&#35201;&#35843;&#29992; <a href="./yii-db-command.html#execute()-detail">execute()</a> &#26469;&#30495;&#27491;&#22320;&#25191;&#34892;&#23427;&#20204;&#12290;</p>
<h2>&#24341;&#29992;&#34920;&#21644;&#21015;&#21517;&#31216;&#65288;Quoting Table and Column Names&#65289;  <span id="quoting-table-and-column-names"></span><a href="#quoting-table-and-column-names" class="hashlink">&para;</a></h2><p>&#24403;&#20889;&#19982;&#25968;&#25454;&#24211;&#26080;&#20851;&#30340;&#20195;&#30721;&#26102;&#65292;&#27491;&#30830;&#22320;&#24341;&#29992;&#34920;&#21644;&#21015;&#21517;&#31216;&#24635;&#26159;&#19968;&#20214;&#22836;&#30140;&#30340;&#20107;&#65292;
&#22240;&#20026;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#26377;&#19981;&#21516;&#30340;&#21517;&#31216;&#24341;&#29992;&#35268;&#21017;&#65292;&#20026;&#20102;&#20811;&#26381;&#36825;&#20010;&#38382;&#39064;&#65292;
&#20320;&#21487;&#20197;&#20351;&#29992;&#19979;&#38754;&#30001; Yii &#25552;&#20986;&#30340;&#24341;&#29992;&#35821;&#27861;&#12290;</p>
<ul>
<li><code>[[column name]]</code>: &#20351;&#29992;&#20004;&#23545;&#26041;&#25324;&#21495;&#26469;&#23558;&#21015;&#21517;&#25324;&#36215;&#26469;; </li>
<li><code>{{table name}}</code>: &#20351;&#29992;&#20004;&#23545;&#22823;&#25324;&#21495;&#26469;&#23558;&#34920;&#21517;&#25324;&#36215;&#26469;&#12290;</li>
</ul>
<p>Yii DAO &#23558;&#33258;&#21160;&#22320;&#26681;&#25454;&#25968;&#25454;&#24211;&#30340;&#20855;&#20307;&#35821;&#27861;&#26469;&#23558;&#36825;&#20123;&#32467;&#26500;&#36716;&#21270;&#20026;&#23545;&#24212;&#30340;
&#34987;&#24341;&#29992;&#30340;&#21015;&#25110;&#32773;&#34920;&#21517;&#31216;&#12290;
&#20363;&#22914;&#65292;</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// &#22312; MySQL &#20013;&#25191;&#34892;&#35813; SQL : SELECT COUNT(`id`) FROM `employee`</span>
$count = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">"SELECT COUNT([[id]]) FROM {{employee}}"</span>)
            -&gt;queryScalar();
</code></pre>
<h3>&#20351;&#29992;&#34920;&#21069;&#32512;&#65288;Using Table Prefix&#65289;  <span id="using-table-prefix"></span><a href="#using-table-prefix" class="hashlink">&para;</a></h3><p>&#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#34920;&#21517;&#22823;&#22810;&#37117;&#25317;&#26377;&#19968;&#20010;&#20849;&#21516;&#30340;&#21069;&#32512;&#65292;
&#20320;&#21487;&#20197;&#20351;&#29992; Yii DAO &#25152;&#25552;&#20379;&#30340;&#34920;&#21069;&#32512;&#21151;&#33021;&#12290;</p>
<p>&#39318;&#20808;&#65292;&#36890;&#36807;&#24212;&#29992;&#37197;&#32622;&#20013;&#30340; <a href="./yii-db-connection.html#%24tablePrefix-detail">yii\db\Connection::$tablePrefix</a> &#23646;&#24615;&#26469;&#25351;&#23450;&#34920;&#21069;&#32512;&#65306;</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'components'</span> =&gt; [
        <span class="hljs-comment">// ...</span>
        <span class="hljs-string">'db'</span> =&gt; [
            <span class="hljs-comment">// ...</span>
            <span class="hljs-string">'tablePrefix'</span> =&gt; <span class="hljs-string">'tbl_'</span>,
        ],
    ],
];
</code></pre>
<p>&#25509;&#30528;&#22312;&#20320;&#30340;&#20195;&#30721;&#20013;&#65292;&#24403;&#20320;&#38656;&#35201;&#28041;&#21450;&#21040;&#19968;&#24352;&#34920;&#21517;&#20013;&#21253;&#21547;&#35813;&#21069;&#32512;&#30340;&#34920;&#26102;&#65292;
&#24212;&#20351;&#29992;&#35821;&#27861; <code>{{%table_name}}</code>&#12290;&#30334;&#20998;&#21495;&#23558;&#34987;&#33258;&#21160;&#22320;&#26367;&#25442;&#20026;&#20320;&#22312;&#37197;&#32622; DB &#32452;&#20214;&#26102;&#25351;&#23450;&#30340;&#34920;&#21069;&#32512;&#12290;
&#20363;&#22914;&#65292;</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// &#22312; MySQL &#20013;&#25191;&#34892;&#35813; SQL: SELECT COUNT(`id`) FROM `tbl_employee`</span>
$count = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">"SELECT COUNT([[id]]) FROM {{%employee}}"</span>)
            -&gt;queryScalar();
</code></pre>
<h2>&#25191;&#34892;&#20107;&#21153;&#65288;Performing Transactions&#65289;  <span id="performing-transactions"></span><a href="#performing-transactions" class="hashlink">&para;</a></h2><p>&#24403;&#39034;&#24207;&#22320;&#25191;&#34892;&#22810;&#20010;&#30456;&#20851;&#30340;&#35821;&#21477;&#26102;&#65292; &#20320;&#25110;&#35768;&#38656;&#35201;&#23558;&#23427;&#20204;&#21253;&#22312;&#19968;&#20010;&#20107;&#21153;&#20013;&#26469;&#20445;&#35777;&#25968;&#25454;&#24211;&#30340;&#23436;&#25972;&#24615;&#21644;&#19968;&#33268;&#24615;&#12290;
&#22914;&#26524;&#36825;&#20123;&#35821;&#21477;&#20013;&#30340;&#20219;&#20309;&#19968;&#20010;&#22833;&#36133;&#20102;&#65292;
&#25968;&#25454;&#24211;&#23558;&#22238;&#28378;&#21040;&#36825;&#20123;&#35821;&#21477;&#25191;&#34892;&#21069;&#30340;&#29366;&#24577;&#12290;</p>
<p>&#19979;&#38754;&#30340;&#20195;&#30721;&#23637;&#31034;&#20102;&#19968;&#20010;&#20351;&#29992;&#20107;&#21153;&#30340;&#20856;&#22411;&#26041;&#27861;&#65306;</p>
<pre><code class="hljs php language-php">Yii::$app-&gt;db-&gt;transaction(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($db)</span> </span>{
    $db-&gt;createCommand($sql1)-&gt;execute();
    $db-&gt;createCommand($sql2)-&gt;execute();
    <span class="hljs-comment">// ... executing other SQL statements ...</span>
});
</code></pre>
<p>&#19978;&#36848;&#20195;&#30721;&#31561;&#20215;&#20110;&#19979;&#38754;&#30340;&#20195;&#30721;&#65292;&#20294;&#26159;&#19979;&#38754;&#30340;&#20195;&#30721;&#32473;&#20104;&#20102;&#20320;&#23545;&#20110;&#38169;&#35823;&#22788;&#29702;&#20195;&#30721;&#30340;&#26356;&#22810;&#25484;&#25511;&#65306;</p>
<pre><code class="hljs php language-php">$db = Yii::$app-&gt;db;
$transaction = $db-&gt;beginTransaction();
<span class="hljs-keyword">try</span> {
    $db-&gt;createCommand($sql1)-&gt;execute();
    $db-&gt;createCommand($sql2)-&gt;execute();
    <span class="hljs-comment">// ... executing other SQL statements ...</span>
    
    $transaction-&gt;commit();
} <span class="hljs-keyword">catch</span>(\<span class="hljs-keyword">Exception</span> $e) {
    $transaction-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
} <span class="hljs-keyword">catch</span>(\Throwable $e) {
    $transaction-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
}
</code></pre>
<p>&#36890;&#36807;&#35843;&#29992; <a href="./yii-db-connection.html#beginTransaction()-detail">beginTransaction()</a> &#26041;&#27861;&#65292;
&#19968;&#20010;&#26032;&#20107;&#21153;&#24320;&#22987;&#20102;&#12290;
&#20107;&#21153;&#34987;&#34920;&#31034;&#20026;&#19968;&#20010;&#23384;&#20648;&#22312; <code>$transaction</code> &#21464;&#37327;&#20013;&#30340; <a href="./yii-db-transaction.html">yii\db\Transaction</a> &#23545;&#35937;&#12290;
&#28982;&#21518;&#65292;&#34987;&#25191;&#34892;&#30340;&#35821;&#21477;&#37117;&#34987;&#21253;&#21547;&#22312;&#19968;&#20010; <code>try...catch...</code> &#22359;&#20013;&#12290;
&#22914;&#26524;&#25152;&#26377;&#30340;&#35821;&#21477;&#37117;&#34987;&#25104;&#21151;&#22320;&#25191;&#34892;&#20102;&#65292;
<a href="./yii-db-transaction.html#commit()-detail">commit()</a> &#23558;&#34987;&#35843;&#29992;&#26469;&#25552;&#20132;&#36825;&#20010;&#20107;&#21153;&#12290;
&#21542;&#21017;&#65292; &#22914;&#26524;&#24322;&#24120;&#34987;&#35302;&#21457;&#24182;&#34987;&#25429;&#33719;&#65292;
<a href="./yii-db-transaction.html#rollBack()-detail">rollBack()</a> &#26041;&#27861;&#23558;&#34987;&#35843;&#29992;&#65292;
&#26469;&#22238;&#28378;&#20107;&#21153;&#20013;&#22833;&#36133;&#35821;&#21477;&#20043;&#21069;&#25152;&#26377;&#35821;&#21477;&#25152;&#36896;&#25104;&#30340;&#25913;&#21464;&#12290;
 <code>throw $e</code> &#23558;&#37325;&#26032;&#25243;&#20986;&#35813;&#24322;&#24120;&#65292;
&#23601;&#22909;&#20687;&#25105;&#20204;&#27809;&#26377;&#25429;&#33719;&#23427;&#19968;&#26679;&#65292;
&#22240;&#27492;&#27491;&#24120;&#30340;&#38169;&#35823;&#22788;&#29702;&#31243;&#24207;&#23558;&#22788;&#29702;&#23427;&#12290;</p>
<h3>&#25351;&#23450;&#38548;&#31163;&#32423;&#21035;&#65288;Specifying Isolation Levels&#65289;  <span id="specifying-isolation-levels"></span><a href="#specifying-isolation-levels" class="hashlink">&para;</a></h3><p>Yii &#20063;&#25903;&#25345;&#20026;&#20320;&#30340;&#20107;&#21153;&#35774;&#32622;<a href="https://zh.wikipedia.org/wiki/%E4%BA%8B%E5%8B%99%E9%9A%94%E9%9B%A2#.E9.9A.94.E7.A6.BB.E7.BA.A7.E5.88.AB">&#38548;&#31163;&#32423;&#21035;</a>&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#24403;&#25105;&#20204;&#24320;&#21551;&#19968;&#20010;&#26032;&#20107;&#21153;&#65292;
&#23427;&#23558;&#20351;&#29992;&#20320;&#30340;&#25968;&#25454;&#24211;&#25152;&#35774;&#23450;&#30340;&#38548;&#31163;&#32423;&#21035;&#12290;&#20320;&#20063;&#21487;&#20197;&#21521;&#19979;&#38754;&#36825;&#26679;&#37325;&#36733;&#40664;&#35748;&#30340;&#38548;&#31163;&#32423;&#21035;&#65292;</p>
<pre><code class="hljs php language-php">$isolationLevel = \yii\db\Transaction::REPEATABLE_READ;

Yii::$app-&gt;db-&gt;transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($db)</span> </span>{
    ....
}, $isolationLevel);
 
<span class="hljs-comment">// or alternatively</span>

$transaction = Yii::$app-&gt;db-&gt;beginTransaction($isolationLevel);
</code></pre>
<p>Yii &#20026;&#22235;&#20010;&#26368;&#24120;&#29992;&#30340;&#38548;&#31163;&#32423;&#21035;&#25552;&#20379;&#20102;&#24120;&#37327;&#65306;</p>
<ul>
<li><a href="./yii-db-transaction.html#READ_UNCOMMITTED-detail">yii\db\Transaction::READ_UNCOMMITTED</a> - &#26368;&#24369;&#30340;&#38548;&#31163;&#32423;&#21035;&#65292;&#33039;&#35835;&#12289;&#19981;&#21487;&#37325;&#22797;&#35835;&#20197;&#21450;&#24187;&#35835;&#37117;&#21487;&#33021;&#21457;&#29983;&#12290;</li>
<li><a href="./yii-db-transaction.html#READ_COMMITTED-detail">yii\db\Transaction::READ_COMMITTED</a> - &#36991;&#20813;&#20102;&#33039;&#35835;&#12290;</li>
<li><a href="./yii-db-transaction.html#REPEATABLE_READ-detail">yii\db\Transaction::REPEATABLE_READ</a> - &#36991;&#20813;&#20102;&#33039;&#35835;&#21644;&#19981;&#21487;&#37325;&#22797;&#35835;&#12290;</li>
<li><a href="./yii-db-transaction.html#SERIALIZABLE-detail">yii\db\Transaction::SERIALIZABLE</a> - &#26368;&#24378;&#30340;&#38548;&#31163;&#32423;&#21035;&#65292; &#36991;&#20813;&#20102;&#19978;&#36848;&#25152;&#26377;&#30340;&#38382;&#39064;&#12290;</li>
</ul>
<p>&#38500;&#20102;&#20351;&#29992;&#19978;&#36848;&#30340;&#24120;&#37327;&#26469;&#25351;&#23450;&#38548;&#31163;&#32423;&#21035;&#65292;&#20320;&#36824;&#21487;&#20197;&#20351;&#29992;&#20320;&#30340;&#25968;&#25454;&#24211;&#25152;&#25903;&#25345;&#30340;&#20855;&#26377;&#26377;&#25928;&#35821;&#27861;&#30340;&#23383;&#31526;&#20018;&#12290;
&#27604;&#22914;&#65292;&#22312; PostgreSQL &#20013;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992; <code>SERIALIZABLE READ ONLY DEFERRABLE</code>&#12290; </p>
<p>&#35831;&#27880;&#24847;&#65292;&#19968;&#20123;&#25968;&#25454;&#24211;&#21482;&#20801;&#35768;&#20026;&#25972;&#20010;&#36830;&#25509;&#35774;&#32622;&#38548;&#31163;&#32423;&#21035;&#65292;
&#21363;&#20351;&#20320;&#20043;&#21518;&#20160;&#20040;&#20063;&#27809;&#25351;&#23450;&#65292;&#21518;&#26469;&#30340;&#20107;&#21153;&#37117;&#23558;&#33719;&#24471;&#19982;&#20043;&#21069;&#30456;&#21516;&#30340;&#38548;&#31163;&#32423;&#21035;&#12290;
&#20351;&#29992;&#27492;&#21151;&#33021;&#26102;&#65292;&#20320;&#38656;&#35201;&#20026;&#25152;&#26377;&#30340;&#20107;&#21153;&#26126;&#30830;&#22320;&#35774;&#32622;&#38548;&#31163;&#32423;&#21035;&#26469;&#36991;&#20813;&#20914;&#31361;&#30340;&#35774;&#32622;&#12290;
&#22312;&#26412;&#25991;&#20889;&#20316;&#20043;&#26102;&#65292;&#21482;&#26377; MSSQL &#21644; SQLite &#21463;&#36825;&#20123;&#38480;&#21046;&#30340;&#24433;&#21709;&#12290;</p>
<blockquote class="note"><p><strong>&#27880;&#24847;&#65306; </strong>SQLite &#21482;&#25903;&#25345;&#20004;&#31181;&#38548;&#31163;&#32423;&#21035;&#65292;&#25152;&#20197;&#20320;&#21482;&#33021;&#20351;&#29992; <code>READ UNCOMMITTED</code> &#21644; <code>SERIALIZABLE</code>&#12290;
&#20351;&#29992;&#20854;&#20182;&#32423;&#21035;&#23558;&#23548;&#33268;&#24322;&#24120;&#30340;&#25243;&#20986;&#12290;</p>
</blockquote>
<blockquote class="note"><p><strong>&#27880;&#24847;&#65306; </strong>PostgreSQL &#19981;&#25903;&#25345;&#22312;&#20107;&#21153;&#24320;&#21551;&#21069;&#35774;&#23450;&#38548;&#31163;&#32423;&#21035;&#65292;
&#22240;&#27492;&#65292;&#20320;&#19981;&#33021;&#22312;&#24320;&#21551;&#20107;&#21153;&#26102;&#30452;&#25509;&#25351;&#23450;&#38548;&#31163;&#32423;&#21035;&#12290;
&#20320;&#24517;&#39035;&#22312;&#20107;&#21153;&#24320;&#22987;&#21518;&#20877;&#35843;&#29992; <a href="./yii-db-transaction.html#setIsolationLevel()-detail">yii\db\Transaction::setIsolationLevel()</a>&#12290;</p>
</blockquote>
<h3>&#23884;&#22871;&#20107;&#21153;&#65288;Nesting Transactions&#65289;  <span id="nesting-transactions"></span><a href="#nesting-transactions" class="hashlink">&para;</a></h3><p>&#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#25903;&#25345;&#20445;&#23384;&#28857;&#65292;&#20320;&#21487;&#20197;&#20687;&#19979;&#38754;&#36825;&#26679;&#23884;&#22871;&#22810;&#20010;&#20107;&#21153;&#65306;</p>
<pre><code class="hljs php language-php">Yii::$app-&gt;db-&gt;transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($db)</span> </span>{
    <span class="hljs-comment">// outer transaction</span>
    
    $db-&gt;transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($db)</span> </span>{
        <span class="hljs-comment">// inner transaction</span>
    });
});
</code></pre>
<p>&#25110;&#32773;&#65292;</p>
<pre><code class="hljs php language-php">$db = Yii::$app-&gt;db;
$outerTransaction = $db-&gt;beginTransaction();
<span class="hljs-keyword">try</span> {
    $db-&gt;createCommand($sql1)-&gt;execute();

    $innerTransaction = $db-&gt;beginTransaction();
    <span class="hljs-keyword">try</span> {
        $db-&gt;createCommand($sql2)-&gt;execute();
        $innerTransaction-&gt;commit();
    } <span class="hljs-keyword">catch</span> (\<span class="hljs-keyword">Exception</span> $e) {
        $innerTransaction-&gt;rollBack();
        <span class="hljs-keyword">throw</span> $e;
    } <span class="hljs-keyword">catch</span> (\Throwable $e) {
        $innerTransaction-&gt;rollBack();
        <span class="hljs-keyword">throw</span> $e;
    }

    $outerTransaction-&gt;commit();
} <span class="hljs-keyword">catch</span> (\<span class="hljs-keyword">Exception</span> $e) {
    $outerTransaction-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
} <span class="hljs-keyword">catch</span> (\Throwable $e) {
    $outerTransaction-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
}
</code></pre>
<h2>&#22797;&#21046;&#21644;&#35835;&#20889;&#20998;&#31163;&#65288;Replication and Read-Write Splitting&#65289;  <span id="read-write-splitting"></span><a href="#read-write-splitting" class="hashlink">&para;</a></h2><p>&#35768;&#22810;&#25968;&#25454;&#24211;&#25903;&#25345;<a href="https://en.wikipedia.org/wiki/Replication_(computing)#Database_replication">&#25968;&#25454;&#24211;&#22797;&#21046;</a>&#26469;&#33719;&#24471;&#26356;&#22909;&#30340;&#25968;&#25454;&#24211;&#21487;&#29992;&#24615;&#65292;
&#20197;&#21450;&#26356;&#24555;&#30340;&#26381;&#21153;&#22120;&#21709;&#24212;&#26102;&#38388;&#12290;&#36890;&#36807;&#25968;&#25454;&#24211;&#22797;&#21046;&#21151;&#33021;&#65292;
&#25968;&#25454;&#20174;&#25152;&#35859;&#30340;&#20027;&#26381;&#21153;&#22120;&#34987;&#22797;&#21046;&#21040;&#20174;&#26381;&#21153;&#22120;&#12290;&#25152;&#26377;&#30340;&#20889;&#21644;&#26356;&#26032;&#24517;&#39035;&#21457;&#29983;&#22312;&#20027;&#26381;&#21153;&#22120;&#19978;&#65292;
&#32780;&#35835;&#21487;&#20197;&#21457;&#29983;&#22312;&#20174;&#26381;&#21153;&#22120;&#19978;&#12290;</p>
<p>&#20026;&#20102;&#21033;&#29992;&#25968;&#25454;&#24211;&#22797;&#21046;&#24182;&#19988;&#23436;&#25104;&#35835;&#20889;&#20998;&#31163;&#65292;
&#20320;&#21487;&#20197;&#25353;&#29031;&#19979;&#38754;&#30340;&#26041;&#27861;&#26469;&#37197;&#32622; <a href="./yii-db-connection.html">yii\db\Connection</a> &#32452;&#20214;&#65306;</p>
<pre><code class="hljs php language-php">[
    <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\db\Connection'</span>,

    <span class="hljs-comment">// &#20027;&#24211;&#30340;&#37197;&#32622;</span>
    <span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for master server'</span>,
    <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'master'</span>,
    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,

    <span class="hljs-comment">// &#20174;&#24211;&#30340;&#36890;&#29992;&#37197;&#32622;</span>
    <span class="hljs-string">'slaveConfig'</span> =&gt; [
        <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'slave'</span>,
        <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
        <span class="hljs-string">'attributes'</span> =&gt; [
            <span class="hljs-comment">// &#20351;&#29992;&#19968;&#20010;&#26356;&#23567;&#30340;&#36830;&#25509;&#36229;&#26102;</span>
            PDO::ATTR_TIMEOUT =&gt; <span class="hljs-number">10</span>,
        ],
    ],

    <span class="hljs-comment">// &#20174;&#24211;&#30340;&#37197;&#32622;&#21015;&#34920;</span>
    <span class="hljs-string">'slaves'</span> =&gt; [
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 1'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 2'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 3'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 4'</span>],
    ],
]
</code></pre>
<p>&#19978;&#36848;&#30340;&#37197;&#32622;&#25351;&#23450;&#20102;&#19968;&#20027;&#22810;&#20174;&#30340;&#35774;&#32622;&#12290;
&#36825;&#20123;&#20174;&#24211;&#20854;&#20013;&#20043;&#19968;&#23558;&#34987;&#24314;&#31435;&#36215;&#36830;&#25509;&#24182;&#25191;&#34892;&#35835;&#25805;&#20316;&#65292;&#32780;&#20027;&#24211;&#23558;&#34987;&#29992;&#26469;&#25191;&#34892;&#20889;&#25805;&#20316;&#12290;
&#36825;&#26679;&#30340;&#35835;&#20889;&#20998;&#31163;&#23558;&#36890;&#36807;&#19978;&#36848;&#37197;&#32622;&#33258;&#21160;&#22320;&#23436;&#25104;&#12290;&#27604;&#22914;&#65292;</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// &#20351;&#29992;&#19978;&#36848;&#37197;&#32622;&#26469;&#21019;&#24314;&#19968;&#20010; Connection &#23454;&#20363;</span>
Yii::$app-&gt;db = Yii::createObject($config);

<span class="hljs-comment">// &#22312;&#20174;&#24211;&#20013;&#30340;&#19968;&#20010;&#19978;&#25191;&#34892;&#35821;&#21477;</span>
$rows = Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM user LIMIT 10'</span>)-&gt;queryAll();

<span class="hljs-comment">// &#22312;&#20027;&#24211;&#19978;&#25191;&#34892;&#35821;&#21477;</span>
Yii::$app-&gt;db-&gt;createCommand(<span class="hljs-string">"UPDATE user SET username='demo' WHERE id=1"</span>)-&gt;execute();
</code></pre>
<blockquote class="info"><p><strong>&#20449;&#24687;&#65306; </strong>&#36890;&#36807;&#35843;&#29992; <a href="./yii-db-command.html#execute()-detail">yii\db\Command::execute()</a> &#26469;&#25191;&#34892;&#30340;&#35821;&#21477;&#37117;&#34987;&#35270;&#20026;&#20889;&#25805;&#20316;&#65292;
  &#32780;&#20854;&#20182;&#25152;&#26377;&#36890;&#36807;&#35843;&#29992; <a href="./yii-db-command.html">yii\db\Command</a> &#20013;&#20219;&#19968; "query" &#26041;&#27861;&#26469;&#25191;&#34892;&#30340;&#35821;&#21477;&#37117;&#34987;&#35270;&#20026;&#35835;&#25805;&#20316;&#12290;
  &#20320;&#21487;&#20197;&#36890;&#36807; <code>Yii::$app-&gt;db-&gt;slave</code> &#26469;&#33719;&#21462;&#24403;&#21069;&#26377;&#25928;&#30340;&#20174;&#24211;&#36830;&#25509;&#12290;</p>
</blockquote>
<p><code>Connection</code> &#32452;&#20214;&#25903;&#25345;&#20174;&#24211;&#38388;&#30340;&#36127;&#36733;&#22343;&#34913;&#21644;&#22833;&#25928;&#22791;&#25588;&#65292;
&#24403;&#31532;&#19968;&#27425;&#25191;&#34892;&#35835;&#25805;&#20316;&#26102;&#65292;<code>Connection</code> &#32452;&#20214;&#23558;&#38543;&#26426;&#22320;&#25361;&#36873;&#20986;&#19968;&#20010;&#20174;&#24211;&#24182;&#23581;&#35797;&#19982;&#20043;&#24314;&#31435;&#36830;&#25509;&#65292;
&#22914;&#26524;&#36825;&#20010;&#20174;&#24211;&#34987;&#21457;&#29616;&#20026;&rdquo;&#25346;&#25481;&#30340;&ldquo;&#65292;&#23558;&#23581;&#35797;&#36830;&#25509;&#21478;&#19968;&#20010;&#20174;&#24211;&#12290;
&#22914;&#26524;&#27809;&#26377;&#19968;&#20010;&#20174;&#24211;&#26159;&#36830;&#25509;&#24471;&#19978;&#30340;&#65292;&#37027;&#20040;&#23558;&#35797;&#30528;&#36830;&#25509;&#21040;&#20027;&#24211;&#19978;&#12290;
&#36890;&#36807;&#37197;&#32622; <a href="./yii-db-connection.html#%24serverStatusCache-detail">server status cache</a>&#65292;
&#19968;&#20010;&ldquo;&#25346;&#25481;&#30340;&rdquo;&#26381;&#21153;&#22120;&#23558;&#20250;&#34987;&#35760;&#20303;&#65292;&#22240;&#27492;&#65292;&#22312;&#19968;&#20010; yii\db\Connection::serverRetryInterval &#20869;&#23558;&#19981;&#20877;&#35797;&#30528;&#36830;&#25509;&#35813;&#26381;&#21153;&#22120;&#12290;</p>
<blockquote class="info"><p><strong>&#20449;&#24687;&#65306; </strong>&#22312;&#19978;&#38754;&#30340;&#37197;&#32622;&#20013;&#65292;
  &#27599;&#20010;&#20174;&#24211;&#37117;&#20849;&#21516;&#22320;&#25351;&#23450;&#20102; 10 &#31186;&#30340;&#36830;&#25509;&#36229;&#26102;&#26102;&#38388;&#65292;&#36825;&#24847;&#21619;&#30528;&#65292;&#22914;&#26524;&#19968;&#20010;&#20174;&#24211;&#22312; 10 &#31186;&#20869;&#19981;&#33021;&#34987;&#36830;&#25509;&#19978;&#65292;&#23427;&#23558;&#34987;&#35270;&#20026;&ldquo;&#25346;&#25481;&#30340;&rdquo;&#12290;
  &#20320;&#21487;&#20197;&#26681;&#25454;&#20320;&#30340;&#23454;&#38469;&#29615;&#22659;&#26469;&#35843;&#25972;&#35813;&#21442;&#25968;&#12290;</p>
</blockquote>
<p>&#20320;&#20063;&#21487;&#20197;&#37197;&#32622;&#22810;&#20027;&#22810;&#20174;&#12290;&#20363;&#22914;&#65292;</p>
<pre><code class="hljs php language-php">[
    <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\db\Connection'</span>,

    <span class="hljs-comment">// &#20027;&#24211;&#36890;&#29992;&#30340;&#37197;&#32622;</span>
    <span class="hljs-string">'masterConfig'</span> =&gt; [
        <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'master'</span>,
        <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
        <span class="hljs-string">'attributes'</span> =&gt; [
            <span class="hljs-comment">// use a smaller connection timeout</span>
            PDO::ATTR_TIMEOUT =&gt; <span class="hljs-number">10</span>,
        ],
    ],

    <span class="hljs-comment">// &#20027;&#24211;&#37197;&#32622;&#21015;&#34920;</span>
    <span class="hljs-string">'masters'</span> =&gt; [
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for master server 1'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for master server 2'</span>],
    ],

    <span class="hljs-comment">// &#20174;&#24211;&#30340;&#36890;&#29992;&#37197;&#32622;</span>
    <span class="hljs-string">'slaveConfig'</span> =&gt; [
        <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'slave'</span>,
        <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,
        <span class="hljs-string">'attributes'</span> =&gt; [
            <span class="hljs-comment">// use a smaller connection timeout</span>
            PDO::ATTR_TIMEOUT =&gt; <span class="hljs-number">10</span>,
        ],
    ],

    <span class="hljs-comment">// &#20174;&#24211;&#37197;&#32622;&#21015;&#34920;</span>
    <span class="hljs-string">'slaves'</span> =&gt; [
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 1'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 2'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 3'</span>],
        [<span class="hljs-string">'dsn'</span> =&gt; <span class="hljs-string">'dsn for slave server 4'</span>],
    ],
]
</code></pre>
<p>&#19978;&#36848;&#37197;&#32622;&#25351;&#23450;&#20102;&#20004;&#20010;&#20027;&#24211;&#21644;&#20004;&#20010;&#20174;&#24211;&#12290; 
<code>Connection</code> &#32452;&#20214;&#22312;&#20027;&#24211;&#20043;&#38388;&#65292;&#20063;&#25903;&#25345;&#22914;&#20174;&#24211;&#38388;&#33324;&#30340;&#36127;&#36733;&#22343;&#34913;&#21644;&#22833;&#25928;&#22791;&#25588;&#12290;
&#21807;&#19968;&#30340;&#24046;&#21035;&#26159;&#65292;&#22914;&#26524;&#27809;&#26377;&#20027;&#24211;&#21487;&#29992;&#65292;&#23558;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;</p>
<blockquote class="note"><p><strong>&#27880;&#24847;&#65306; </strong>&#24403;&#20320;&#20351;&#29992; <a href="./yii-db-connection.html#%24masters-detail">masters</a> &#23646;&#24615;&#26469;&#37197;&#32622;&#19968;&#20010;&#25110;&#22810;&#20010;&#20027;&#24211;&#26102;&#65292;
  &#25152;&#26377;&#20854;&#20182;&#25351;&#23450;&#25968;&#25454;&#24211;&#36830;&#25509;&#30340;&#23646;&#24615; (&#20363;&#22914; <code>dsn</code>, <code>username</code>, <code>password</code>) 
  &#19982; <code>Connection</code> &#23545;&#35937;&#26412;&#36523;&#23558;&#34987;&#24573;&#30053;&#12290;</p>
</blockquote>
<p>&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#20107;&#21153;&#20351;&#29992;&#20027;&#24211;&#36830;&#25509;&#65292;
&#19968;&#20010;&#20107;&#21153;&#20869;&#65292;&#25152;&#26377;&#30340;&#25968;&#25454;&#24211;&#25805;&#20316;&#37117;&#23558;&#20351;&#29992;&#20027;&#24211;&#36830;&#25509;&#65292;&#20363;&#22914;&#65292;</p>
<pre><code class="hljs php language-php">$db = Yii::$app-&gt;db;
<span class="hljs-comment">// &#22312;&#20027;&#24211;&#19978;&#21551;&#21160;&#20107;&#21153;</span>
$transaction = $db-&gt;beginTransaction();

<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// &#20004;&#20010;&#35821;&#21477;&#37117;&#26159;&#22312;&#20027;&#24211;&#19978;&#25191;&#34892;&#30340;</span>
    $rows = $db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM user LIMIT 10'</span>)-&gt;queryAll();
    $db-&gt;createCommand(<span class="hljs-string">"UPDATE user SET username='demo' WHERE id=1"</span>)-&gt;execute();

    $transaction-&gt;commit();
} <span class="hljs-keyword">catch</span>(\<span class="hljs-keyword">Exception</span> $e) {
    $transaction-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
} <span class="hljs-keyword">catch</span>(\Throwable $e) {
    $transaction-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
}
</code></pre>
<p>&#22914;&#26524;&#20320;&#24819;&#22312;&#20174;&#24211;&#19978;&#24320;&#21551;&#20107;&#21153;&#65292;&#20320;&#24212;&#35813;&#26126;&#30830;&#22320;&#20687;&#19979;&#38754;&#36825;&#26679;&#20570;&#65306;</p>
<pre><code class="hljs php language-php">$transaction = Yii::$app-&gt;db-&gt;slave-&gt;beginTransaction();
</code></pre>
<p>&#26377;&#26102;&#65292;&#20320;&#25110;&#35768;&#24819;&#35201;&#24378;&#21046;&#20351;&#29992;&#20027;&#24211;&#26469;&#25191;&#34892;&#35835;&#26597;&#35810;&#12290;
&#36825;&#21487;&#20197;&#36890;&#36807; <code>useMaster()</code> &#26041;&#27861;&#26469;&#23436;&#25104;&#65306;</p>
<pre><code class="hljs php language-php">$rows = Yii::$app-&gt;db-&gt;useMaster(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($db)</span> </span>{
    <span class="hljs-keyword">return</span> $db-&gt;createCommand(<span class="hljs-string">'SELECT * FROM user LIMIT 10'</span>)-&gt;queryAll();
});
</code></pre>
<p>&#20320;&#20063;&#21487;&#20197;&#26126;&#30830;&#22320;&#23558; <code>Yii::$app-&gt;db-&gt;enableSlaves</code> &#35774;&#32622;&#20026; false &#26469;&#23558;&#25152;&#26377;&#30340;&#35835;&#25805;&#20316;&#25351;&#21521;&#20027;&#24211;&#36830;&#25509;&#12290;</p>
<h2>&#25805;&#32437;&#25968;&#25454;&#24211;&#27169;&#24335;&#65288;Working with Database Schema&#65289;  <span id="database-schema"></span><a href="#database-schema" class="hashlink">&para;</a></h2><p>Yii DAO &#25552;&#20379;&#20102;&#19968;&#22871;&#23436;&#25972;&#30340;&#26041;&#27861;&#26469;&#35753;&#20320;&#25805;&#32437;&#25968;&#25454;&#24211;&#27169;&#24335;&#65292;
&#22914;&#21019;&#24314;&#34920;&#12289;&#20174;&#34920;&#20013;&#21024;&#38500;&#19968;&#21015;&#65292;&#31561;&#31561;&#12290;&#36825;&#20123;&#26041;&#27861;&#32599;&#21015;&#22914;&#19979;&#65306;</p>
<ul>
<li><a href="./yii-db-command.html#createTable()-detail">createTable()</a>&#65306;&#21019;&#24314;&#19968;&#24352;&#34920;</li>
<li><a href="./yii-db-command.html#renameTable()-detail">renameTable()</a>&#65306;&#37325;&#21629;&#21517;&#19968;&#24352;&#34920;</li>
<li><a href="./yii-db-command.html#dropTable()-detail">dropTable()</a>&#65306;&#21024;&#38500;&#19968;&#24352;&#34920;</li>
<li><a href="./yii-db-command.html#truncateTable()-detail">truncateTable()</a>&#65306;&#21024;&#38500;&#19968;&#24352;&#34920;&#20013;&#30340;&#25152;&#26377;&#34892;</li>
<li><a href="./yii-db-command.html#addColumn()-detail">addColumn()</a>&#65306;&#22686;&#21152;&#19968;&#21015;</li>
<li><a href="./yii-db-command.html#renameColumn()-detail">renameColumn()</a>&#65306;&#37325;&#21629;&#21517;&#19968;&#21015;</li>
<li><a href="./yii-db-command.html#dropColumn()-detail">dropColumn()</a>&#65306;&#21024;&#38500;&#19968;&#21015;</li>
<li><a href="./yii-db-command.html#alterColumn()-detail">alterColumn()</a>&#65306;&#20462;&#25913;&#19968;&#21015;</li>
<li><a href="./yii-db-command.html#addPrimaryKey()-detail">addPrimaryKey()</a>&#65306;&#22686;&#21152;&#20027;&#38190;</li>
<li><a href="./yii-db-command.html#dropPrimaryKey()-detail">dropPrimaryKey()</a>&#65306;&#21024;&#38500;&#20027;&#38190;</li>
<li><a href="./yii-db-command.html#addForeignKey()-detail">addForeignKey()</a>&#65306;&#22686;&#21152;&#19968;&#20010;&#22806;&#38190;</li>
<li><a href="./yii-db-command.html#dropForeignKey()-detail">dropForeignKey()</a>&#65306;&#21024;&#38500;&#19968;&#20010;&#22806;&#38190;</li>
<li><a href="./yii-db-command.html#createIndex()-detail">createIndex()</a>&#65306;&#22686;&#21152;&#19968;&#20010;&#32034;&#24341;</li>
<li><a href="./yii-db-command.html#dropIndex()-detail">dropIndex()</a>&#65306;&#21024;&#38500;&#19968;&#20010;&#32034;&#24341;</li>
</ul>
<p>&#36825;&#20123;&#26041;&#27861;&#21487;&#20197;&#22914;&#19979;&#22320;&#20351;&#29992;&#65306;</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// CREATE TABLE</span>
Yii::$app-&gt;db-&gt;createCommand()-&gt;createTable(<span class="hljs-string">'post'</span>, [
    <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'pk'</span>,
    <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'string'</span>,
    <span class="hljs-string">'text'</span> =&gt; <span class="hljs-string">'text'</span>,
]);
</code></pre>
<p>&#19978;&#38754;&#30340;&#25968;&#32452;&#25551;&#36848;&#35201;&#21019;&#24314;&#30340;&#21015;&#30340;&#21517;&#31216;&#21644;&#31867;&#22411;&#12290;
&#23545;&#20110;&#21015;&#30340;&#31867;&#22411;&#65292; Yii &#25552;&#20379;&#20102;&#19968;&#22871;&#25277;&#35937;&#25968;&#25454;&#31867;&#22411;&#26469;&#20801;&#35768;&#20320;&#23450;&#20041;&#20986;&#25968;&#25454;&#24211;&#26080;&#20851;&#30340;&#27169;&#24335;&#12290;
&#36825;&#20123;&#23558;&#26681;&#25454;&#34920;&#25152;&#22312;&#25968;&#25454;&#24211;&#30340;&#31181;&#31867;&#65292;&#34987;&#36716;&#25442;&#20026;&#29305;&#23450;&#30340;&#31867;&#22411;&#23450;&#20041;&#12290;
&#35831;&#21442;&#32771; <a href="./yii-db-command.html#createTable()-detail">createTable()</a>-method &#30340; API &#25991;&#26723;&#26469;&#33719;&#21462;&#26356;&#22810;&#20449;&#24687;&#12290;</p>
<p>&#38500;&#20102;&#25913;&#21464;&#25968;&#25454;&#24211;&#27169;&#24335;&#65292;
&#20320;&#20063;&#21487;&#20197;&#36890;&#36807; DB Connection &#30340; <a href="./yii-db-connection.html#getTableSchema()-detail">getTableSchema()</a> &#26041;&#27861;&#26469;&#26816;&#32034;&#26576;&#24352;&#34920;&#30340;&#23450;&#20041;&#20449;&#24687;&#12290;&#20363;&#22914;&#65292;</p>
<pre><code class="hljs php language-php">$table = Yii::$app-&gt;db-&gt;getTableSchema(<span class="hljs-string">'post'</span>);
</code></pre>
<p>&#35813;&#26041;&#27861;&#36820;&#22238;&#19968;&#20010; <a href="./yii-db-tableschema.html">yii\db\TableSchema</a> &#23545;&#35937;&#65292;
&#23427;&#21253;&#21547;&#20102;&#34920;&#20013;&#30340;&#21015;&#12289;&#20027;&#38190;&#12289;&#22806;&#38190;&#65292;&#31561;&#31561;&#30340;&#20449;&#24687;&#12290;
&#25152;&#26377;&#30340;&#36825;&#20123;&#20449;&#24687;&#20027;&#35201;&#34987; <a href="guide-db-query-builder.html">query builder</a> &#21644; <a href="guide-db-active-record.html">active record</a> &#25152;&#20351;&#29992;&#65292;&#26469;&#24110;&#21161;&#20320;&#20889;&#20986;&#25968;&#25454;&#24211;&#26080;&#20851;&#30340;&#20195;&#30721;&#12290;</p>
</body></html>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Mon, 25 Mar 2024 04:16:20 +0000</small></p>
    Powered by <a href="https://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script>jQuery(function ($) {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
